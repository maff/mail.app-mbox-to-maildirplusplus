WARNING: This script is alpha software and was developed for a single purpose. Use at own risk!

Converts mbox directory structure generated by Mail.app export to a Maildir++ mbox structure as described on the Dovecot Wiki. This structure can be read by Dovecot and further be processed to get a Maildir structure.

The file layout created by this script can be used with tools like dsync and Dovecot to create valid IMAP mailboxes. Assuming your Mail.app export is in ~/export, first setup Dovecot to use the desired target storage type. E.g.:

    mail_location = maildir:~/Maildir

Afterwards, use this script to create a filesystem layout which can be read by Dovecot:

    $ mkdir -p ~/mail/{index,control}
    $ touch ~/mail/inbox
    $ ~/mail.app-mbox-to-maildirplusplus/cli.php convert:mbox ~/export ~/mail

Configuring dovecot to use mbox with the maildir++ layout as described on the Wiki would work, but you can use dsync to convert the generated directory to a Maildir structure:

    $ dsync -u myuser mirror mbox:~/mail:LAYOUT=maildir++:INDEX=~/mail/index:CONTROL=~/mail/control

== Documentation ==

* http://wiki2.dovecot.org/MboxChildFolders
* http://wiki2.dovecot.org/Tools/Dsync
